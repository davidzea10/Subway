<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>Mboka Runner</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div id="conteneur-jeu">
    <!-- √âcran 0 : Splash / entr√©e (logo plein √©cran + bouton superpos√©) -->
    <div id="ecran-splash" class="ecran-entree">
      <img src="public/logo.png" alt="Mboka Runner" class="logo-splash">
      <button type="button" id="bouton-commencer" class="cta-commencer">Commencer</button>
    </div>

    <!-- √âcran 1 : Accueil (pseudo + menu) -->
    <div id="ecran-accueil" class="cache">
      <button type="button" id="bouton-retour-accueil" class="bouton-retour" aria-label="Retour">‚Üê Retour</button>
      <div class="accueil-contenu-principal">
        <h1 class="logo-accueil">Mboka Runner</h1>
        <p class="sous-titre">√âvite les obstacles !</p>
        <div class="champ-nom">
          <label for="input-nom">Ton pseudo :</label>
          <input type="text" id="input-nom" placeholder="Entre ton nom" maxlength="20" autocomplete="off">
        </div>
        <button type="button" id="bouton-continuer" class="cta-principal">Continuer</button>
      </div>
      <div class="accueil-menu-zone">
        <button type="button" id="bouton-menu-toggle" class="bouton-menu-toggle" aria-label="Menu">‚ò∞ Menu</button>
        <div id="panel-menu-accueil" class="panel-menu-accueil cache">
          <button type="button" id="bouton-aide">Aide</button>
          <button type="button" id="bouton-historique">Historique</button>
          <button type="button" id="bouton-classement">Classement</button>
          <button type="button" id="bouton-remarques">Remarques</button>
          <button type="button" id="bouton-apropos">√Ä propos</button>
        </div>
      </div>
    </div>

    <!-- √âcran 2 : Choix du personnage -->
    <div id="ecran-choix-personnage" class="cache">
      <button type="button" id="bouton-retour-personnage" class="bouton-retour" aria-label="Retour">‚Üê Retour</button>
      <h2>Choisis ton personnage</h2>
      <p class="joueur-nom"><span id="texte-joueur"></span></p>
      <div id="grille-personnages">
        <button type="button" class="choix-perso" data-perso="0" title="H√©ros bleu">
          <canvas class="apercu-perso" width="80" height="80"></canvas>
          <span>H√©ros</span>
        </button>
        <button type="button" class="choix-perso" data-perso="1" title="Explorateur vert">
          <canvas class="apercu-perso" width="80" height="80"></canvas>
          <span>Explorateur</span>
        </button>
        <button type="button" class="choix-perso" data-perso="2" title="Savant orange">
          <canvas class="apercu-perso" width="80" height="80"></canvas>
          <span>Savant</span>
        </button>
        <button type="button" class="choix-perso" data-perso="3" title="Fant√¥me violet">
          <canvas class="apercu-perso" width="80" height="80"></canvas>
          <span>Fant√¥me</span>
        </button>
      </div>
      <button type="button" id="bouton-jouer">Jouer</button>
    </div>

    <!-- Page Aide (overlay) -->
    <div id="page-aide" class="overlay cache">
      <div class="overlay-contenu">
        <h2>Aide</h2>
        <div class="texte-aide">
          <p><strong>Objectif :</strong> Atteindre 1500 points en 5 √©tapes (300 points par √©tape).</p>
          <p><strong>D√©placements :</strong></p>
          <p><kbd>‚Üê</kbd> <kbd>‚Üí</kbd> ou <kbd>Q</kbd> <kbd>D</kbd> : Gauche / Droite</p>
          <p><kbd>‚Üë</kbd> <kbd>‚Üì</kbd> ou <kbd>Z</kbd> <kbd>S</kbd> : Avancer / Reculer</p>
          <p>Sur mobile : glisse le doigt sur l'√©cran (haut, bas, gauche, droite) pour te d√©placer. Un geste = une case.</p>
          <p>Un appui = une case. √âvite les obstacles qui tombent !</p>
          <p><strong>√âtoiles :</strong> +1 vie (max 5). <strong>Parasites rouges :</strong> -2 vies.</p>
        </div>
        <button type="button" class="bouton-fermer-overlay" id="fermer-aide">Fermer</button>
      </div>
    </div>

    <!-- Page Historique (overlay) ‚Äî uniquement pour le pseudo saisi sur cet appareil -->
    <div id="page-historique" class="overlay cache">
      <div class="overlay-contenu">
        <h2>Historique des parties</h2>
        <p id="sous-titre-historique" class="sous-titre-historique"></p>
        <ul id="liste-historique"></ul>
        <button type="button" class="bouton-fermer-overlay" id="fermer-historique">Fermer</button>
      </div>
    </div>

    <!-- Page Classement (scores en ligne Supabase) -->
    <div id="page-classement" class="overlay cache">
      <div class="overlay-contenu overlay-classement">
        <h2 class="titre-classement">üèÜ Classement</h2>
        <p class="sous-titre-classement">Un pseudo = une place. Le meilleur score est conserv√©.</p>
        <div class="filtres-classement">
          <label for="filtre-classement" class="label-filtre">P√©riode</label>
          <select id="filtre-classement">
            <option value="tous">Tous</option>
            <option value="heure">Derni√®re heure</option>
            <option value="jour">Aujourd'hui</option>
            <option value="semaine">Cette semaine</option>
            <option value="mois">Ce mois</option>
            <option value="victoires">Victoires uniquement</option>
          </select>
        </div>
        <p id="message-chargement-classement" class="message-info">Chargement‚Ä¶</p>
        <div id="liste-classement" class="liste-classement-widget"></div>
        <button type="button" class="bouton-fermer-overlay" id="fermer-classement">Fermer</button>
      </div>
    </div>

    <!-- Page Remarques (envoi au dev, seul le dev peut lire dans Supabase) -->
    <div id="page-remarques" class="overlay cache">
      <div class="overlay-contenu">
        <h2>Envoyer une remarque</h2>
        <p class="texte-remarques">Ton message ne sera lu que par le cr√©ateur du jeu.</p>
        <div class="form-remarques">
          <label for="input-remarque-pseudo">Ton pseudo (optionnel)</label>
          <input type="text" id="input-remarque-pseudo" placeholder="Pseudo" maxlength="30" autocomplete="off">
          <label for="input-remarque-texte">Message</label>
          <textarea id="input-remarque-texte" placeholder="√âcris ta remarque ici‚Ä¶" rows="4" maxlength="500"></textarea>
          <p id="message-envoi-remarque" class="message-info cache"></p>
          <button type="button" id="bouton-envoyer-remarque">Envoyer</button>
        </div>
        <button type="button" class="bouton-fermer-overlay" id="fermer-remarques">Fermer</button>
      </div>
    </div>

    <!-- Page Commentaires (temps r√©el, pause le jeu) -->
    <div id="page-commentaires" class="overlay cache">
      <div class="overlay-contenu overlay-commentaires">
        <h2>üí¨ Commentaires en direct</h2>
        <div id="liste-commentaires" class="liste-commentaires"></div>
        <div class="form-commentaire">
          <input type="text" id="input-commentaire" placeholder="√âcris un commentaire‚Ä¶" maxlength="200" autocomplete="off">
          <button type="button" id="bouton-envoyer-commentaire">Envoyer</button>
        </div>
        <button type="button" class="bouton-fermer-overlay" id="fermer-commentaires">Fermer</button>
      </div>
    </div>

    <!-- Page √Ä propos -->
    <div id="page-apropos" class="overlay cache">
      <div class="overlay-contenu">
        <h2>√Ä propos</h2>
        <p class="auteur-apropos"><strong>R√©alis√© par D√©buze David</strong></p>
        <button type="button" class="bouton-fermer-overlay" id="fermer-apropos">Fermer</button>
      </div>
    </div>

    <!-- Zone de jeu -->
    <canvas id="zone-jeu"></canvas>

    <!-- Bouton commentaires (pendant le jeu) -->
    <button type="button" id="bouton-commentaires-jeu" class="bouton-commentaires-jeu cache" aria-label="Commentaires">
      üí¨ <span id="badge-commentaires" class="badge-commentaires cache">0</span>
    </button>

    <!-- Alerte derni√®re vie (centr√©e sur le jeu) -->
    <p id="alerte-vies" class="alerte-vies cache" aria-live="polite"></p>

    <!-- Interface en jeu (score, √©tape, vies en haut) -->
    <div id="interface-jeu" class="cache">
      <div id="affichage-etape">
        <span>√âtape :</span>
        <span id="valeur-etape">1</span><span>/5</span>
      </div>
      <div id="affichage-score">
        <span>Score :</span>
        <span id="valeur-score">0</span>
      </div>
      <div id="affichage-vies">
        <span>Vies :</span>
        <span id="valeur-vies">3</span>
      </div>
    </div>

    <!-- Boutons Pause / Quitter (en bas du conteneur, s√©par√©s du score) -->
    <div id="boutons-jeu" class="cache">
      <button type="button" id="bouton-pause">Pause</button>
      <button type="button" id="bouton-quitter">Quitter</button>
    </div>

    <!-- Overlay Pause -->
    <div id="ecran-pause" class="overlay cache">
      <div class="overlay-contenu overlay-pause">
        <h2>Pause</h2>
        <button type="button" id="bouton-reprendre">Reprendre</button>
      </div>
    </div>

    <!-- √âcran de game over (message en lingala selon l'√©tape) -->
    <div id="ecran-game-over" class="cache">
      <h2 id="message-gameover-lingala">Okufi</h2>
      <p class="score-final-label">Score : <span id="score-final">0</span></p>
      <p id="place-gameover" class="place-gameover cache">Ta place : <span id="valeur-place">‚Äî</span></p>
      <div class="boutons-game-over">
        <button type="button" id="bouton-rejouer">Rejouer</button>
        <button type="button" id="bouton-commentaires-gameover" class="bouton-commentaires-gameover">üí¨ Commentaires</button>
        <button type="button" id="bouton-classement-gameover">Voir le Classement</button>
        <button type="button" id="bouton-quitter-gameover">Quitter</button>
      </div>
    </div>

    <!-- √âcran de victoire -->
    <div id="ecran-victoire" class="cache">
      <h2>Victoire !</h2>
      <p>Tu as r√©ussi les 5 √©tapes.</p>
      <p>Score final : <span id="score-victoire">0</span></p>
      <button id="bouton-rejouer-victoire">Rejouer</button>
    </div>
  </div>

  <script src="supabaseConfig.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="animations.js"></script>
  <script src="jeu.js"></script>
</body>
</html>
